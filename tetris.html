<!doctype html>
<html>
	<head>
	</head>
	<body>
		<canvas id="canvas" style="display: block; margin: 0 auto; border: 1px solid black" width="350px" height="700px"></canvas>
		<script type="text/javascript">
			var canvas = document.getElementById("canvas");
			var c = canvas.getContext("2d");
			c.fillStyle = "black";
			
			function fillSquare(x, y) {
				c.fillStyle = "black";
				c.fillRect(x * 35, y * 35, 35, 35);
			}
			
			var key;
			document.addEventListener("keydown", function(e) {
				if (shapes[shapes.length - 1].active) {
					switch (e.keyCode) {
							case 37: shapes[shapes.length - 1].move("left");
							break;
							case 39: shapes[shapes.length - 1].move("right");
							break;
							case 40: shapes[shapes.length - 1].move("down");
							break;
							default: 
							break;
						}
				}
			}, false);
			document.addEventListener("keyup", function(e) {
				key = false;
			}, false);
			
			
			function Shape(x, y) {
				this.x = x;
				this.y = y;
				this.active = true;
				this.draw = function() {
					fillSquare(this.x, this.y);
					if (this.y >= 19) {
						this.active = false;
					}
					console.log(this.y);
				}
				this.move = function(dir) {
					if (dir === "down") {
						this.y++;
					}
					else if (dir === "left") {
						this.x--;
					}
					else if (dir === "right") {
						this.x++;
					}
					
				}
			}
			
			var shapes = [];
			shapes[0] = new Shape(0, 0);
			
			
		
			window.setInterval(function() {
				if (shapes[shapes.length - 1].active) {
					shapes[shapes.length - 1].y++;
				}
			}, 1000);
			
			function update() {
				c.fillStyle = "white";
				c.fillRect(0, 0, canvas.width, canvas.height);
				c.fillStyle = "black";
				for (var i = 0; i < 20; i++) {
					c.fillRect(0, 35 * i, 350, 1);
				}
				for (var i = 0; i < 10; i++) {
					c.fillRect(i * 35, 0, 1, 700);
				}
				for (var i = 0; i < shapes.length; i++) {
					shapes[i].draw();

				}
				
				if (!shapes[shapes.length - 1].active) {
					shapes[shapes.length] = new Shape(0, 0);
				}
				
				console.log(key);
				requestAnimationFrame(update);
			}
			
			update();
		</script>
	</body>
</html>